<!DOCTYPE html>
<html lang="en" x-data="{ 
    darkMode: localStorage.getItem('darkMode') === 'true',
    sidebarOpen: window.innerWidth >= 1024,
    isDesktop: window.innerWidth >= 1024,
    userClosedSidebar: false,
    profileDropdownOpen: false,
    notificationDropdownOpen: false,
    loginModalOpen: false,
    admissionModalOpen: false,
    comingSoonModalOpen: false,
    comingSoonTitle: ''
}" 
      :class="{ 'dark': darkMode }"
      x-init="
        // Initialize dark mode
        if (darkMode) {
            document.documentElement.classList.add('dark');
        }
        
        // Handle window resize
        let resizeTimeout;
        window.addEventListener('resize', () => {
            clearTimeout(resizeTimeout);
            resizeTimeout = setTimeout(() => {
                const wasDesktop = isDesktop;
                isDesktop = window.innerWidth >= 1024;
                
                if (isDesktop && !wasDesktop && !userClosedSidebar) {
                    sidebarOpen = true;
                } else if (!isDesktop && wasDesktop) {
                    sidebarOpen = false;
                    userClosedSidebar = false;
                }
            }, 150);
        });
        
        // Watch dark mode changes
        $watch('darkMode', value => {
            localStorage.setItem('darkMode', value);
            if (value) {
                document.documentElement.classList.add('dark');
            } else {
                document.documentElement.classList.remove('dark');
            }
        });
        
        // Store initial scroll position
        let scrollPosition = 0;
        let touchStartY = 0;
        
        // Function to prevent body scrolling
        function preventBodyScroll(e) {
            if (!isDesktop && sidebarOpen) {
                const sidebar = document.querySelector('aside');
                const sidebarNav = document.querySelector('.sidebar-nav');
                
                // If event is from sidebar navigation, allow it
                if (sidebarNav && (sidebarNav.contains(e.target) || sidebarNav === e.target)) {
                    // Check if sidebar can scroll in this direction
                    const nav = sidebarNav;
                    const isAtTop = nav.scrollTop <= 1;
                    const isAtBottom = nav.scrollTop + nav.clientHeight >= nav.scrollHeight - 1;
                    
                    if (e.type === 'touchmove') {
                        const touch = e.touches[0];
                        if (touch) {
                            const deltaY = touch.clientY - touchStartY;
                            
                            // If at top and trying to scroll up, or at bottom and trying to scroll down, prevent
                            if ((isAtTop && deltaY > 0) || (isAtBottom && deltaY < 0)) {
                                e.preventDefault();
                                e.stopPropagation();
                                return false;
                            }
                        }
                    } else if (e.type === 'wheel') {
                        // If at boundaries and trying to scroll beyond, prevent
                        if ((isAtTop && e.deltaY < 0) || (isAtBottom && e.deltaY > 0)) {
                            e.preventDefault();
                            e.stopPropagation();
                            return false;
                        }
                    }
                    // Allow scrolling within sidebar
                    return true;
                }
                
                // If event is from sidebar container but not nav, allow
                if (sidebar && sidebar.contains(e.target) && !sidebarNav.contains(e.target)) {
                    return true;
                }
                
                // Prevent all scrolling outside sidebar
                e.preventDefault();
                e.stopPropagation();
                return false;
            }
        }
        
        // Track touch start for scroll direction detection
        function handleTouchStart(e) {
            if (!isDesktop && sidebarOpen) {
                const touch = e.touches[0];
                if (touch) {
                    touchStartY = touch.clientY;
                }
            }
        }
        
        // Prevent body scroll when sidebar is open on mobile
        $watch('sidebarOpen', value => {
            if (!isDesktop && value) {
                // Save current scroll position
                scrollPosition = window.pageYOffset || document.documentElement.scrollTop;
                
                // Lock body scroll
                document.documentElement.classList.add('sidebar-open-mobile');
                document.body.classList.add('sidebar-open-mobile');
                document.body.style.overflow = 'hidden';
                document.body.style.position = 'fixed';
                document.body.style.top = `-${scrollPosition}px`;
                document.body.style.width = '100%';
                document.body.style.height = '100%';
                document.body.style.touchAction = 'none';
                
                // Prevent touch scrolling on body (except sidebar)
                document.addEventListener('touchstart', handleTouchStart, { passive: true });
                document.addEventListener('touchmove', preventBodyScroll, { passive: false });
                document.addEventListener('wheel', preventBodyScroll, { passive: false });
                document.addEventListener('scroll', preventBodyScroll, { passive: false });
            } else {
                // Restore scroll position
                document.documentElement.classList.remove('sidebar-open-mobile');
                document.body.classList.remove('sidebar-open-mobile');
                document.body.style.overflow = '';
                document.body.style.position = '';
                document.body.style.top = '';
                document.body.style.width = '';
                document.body.style.height = '';
                document.body.style.touchAction = '';
                
                // Restore scroll position
                window.scrollTo(0, scrollPosition);
                
                // Remove event listeners
                document.removeEventListener('touchstart', handleTouchStart);
                document.removeEventListener('touchmove', preventBodyScroll);
                document.removeEventListener('wheel', preventBodyScroll);
                document.removeEventListener('scroll', preventBodyScroll);
            }
        });
        
        // Also watch isDesktop changes
        $watch('isDesktop', value => {
            if (value || !sidebarOpen) {
                document.documentElement.classList.remove('sidebar-open-mobile');
                document.body.classList.remove('sidebar-open-mobile');
                document.body.style.overflow = '';
                document.body.style.position = '';
                document.body.style.top = '';
                document.body.style.width = '';
                document.body.style.height = '';
                document.body.style.touchAction = '';
                document.removeEventListener('touchstart', handleTouchStart);
                document.removeEventListener('touchmove', preventBodyScroll);
                document.removeEventListener('wheel', preventBodyScroll);
                document.removeEventListener('scroll', preventBodyScroll);
            }
        });
      ">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
    <title>{% block title %}{{ school_settings.school_name or 'Modern School' }}{% endblock %}</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        'brand-primary': '#800020',
                        'brand-secondary': '#A00030',
                        'brand-maroon': '#800020',
                        'brand-maroon-dark': '#5C0014',
                        'brand-maroon-light': '#A00030',
                    },
                    fontFamily: {
                        'sans': ['Inter', 'system-ui', 'sans-serif'],
                        'heading': ['Poppins', 'Inter', 'system-ui', 'sans-serif'],
                    }
                }
            }
        }
    </script>
    
    <!-- Alpine.js -->
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Custom CSS -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/custom.css') }}">
    <!-- Modern Background Images CSS -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/modern-background.css') }}">
    
    <!-- Role-specific theme colors (for dashboard pages) -->
    <style>
        :root {
            --role-primary: {% block role_primary %}#800020{% endblock %};
            --role-secondary: {% block role_secondary %}#A00030{% endblock %};
            --role-accent: {% block role_accent %}#800020{% endblock %};
        }
        
        [x-cloak] { display: none !important; }
        
        /* Responsive base styles */
        * {
            box-sizing: border-box;
        }
        
        html, body {
            margin: 0;
            padding: 0;
            width: 100%;
            max-width: 100vw;
            overflow-x: hidden;
        }
        
        /* Sidebar transitions */
        .sidebar-transition {
            transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        /* Mobile sidebar improvements */
        @media (max-width: 1023px) {
            aside {
                height: 100vh;
                top: 0;
            }
        }
        
        /* Desktop sidebar */
        @media (min-width: 1024px) {
            aside {
                height: calc(100vh - 4rem);
                top: 4rem;
            }
        }
        
        /* Custom scrollbar */
        .custom-scrollbar::-webkit-scrollbar {
            width: 8px;
        }
        
        .custom-scrollbar::-webkit-scrollbar-track {
            background: rgba(0, 0, 0, 0.05);
            border-radius: 4px;
        }
        
        .custom-scrollbar::-webkit-scrollbar-thumb {
            background: rgba(0, 0, 0, 0.2);
            border-radius: 4px;
            transition: background 0.2s ease;
        }
        
        .custom-scrollbar::-webkit-scrollbar-thumb:hover {
            background: rgba(0, 0, 0, 0.4);
        }
        
        .dark .custom-scrollbar::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.05);
        }
        
        .dark .custom-scrollbar::-webkit-scrollbar-thumb {
            background: rgba(255, 255, 255, 0.2);
        }
        
        .dark .custom-scrollbar::-webkit-scrollbar-thumb:hover {
            background: rgba(255, 255, 255, 0.3);
        }
        
        /* Sidebar scrollable container */
        .sidebar-scrollable {
            height: calc(100vh - 4rem - 4rem);
            overflow-y: auto;
            overflow-x: hidden;
                -webkit-overflow-scrolling: touch;
            }
        
        @media (max-width: 1023px) {
            .sidebar-scrollable {
                height: calc(100vh - 4rem);
            }
        }
        
        /* Prevent body scroll when sidebar is open on mobile */
        body.sidebar-open-mobile {
            overflow: hidden !important;
            position: fixed !important;
            width: 100% !important;
            height: 100% !important;
            touch-action: none !important;
            -webkit-overflow-scrolling: none !important;
        }
        
        /* Prevent scrolling on html element too */
        html.sidebar-open-mobile {
            overflow: hidden !important;
            height: 100% !important;
            position: relative !important;
        }
        
        /* Ensure sidebar can still scroll */
        aside .sidebar-nav {
            -webkit-overflow-scrolling: touch;
            overscroll-behavior: contain;
            touch-action: pan-y;
        }
        
        /* Prevent any scroll on main content when sidebar is open on mobile */
        @media (max-width: 1023px) {
            body.sidebar-open-mobile main {
                overflow: hidden !important;
                touch-action: none !important;
            }
            
            body.sidebar-open-mobile * {
                overscroll-behavior: none;
            }
            
            body.sidebar-open-mobile aside .sidebar-nav {
                overscroll-behavior: contain;
                touch-action: pan-y;
            }
        }
        
        /* Touch-friendly */
        button, a {
            -webkit-tap-highlight-color: rgba(0, 0, 0, 0.1);
            touch-action: manipulation;
        }
        
        /* Modern button styles */
        button, .btn {
            transition: all 0.2s ease;
        }
        
        button:hover, .btn:hover {
            transform: translateY(-1px);
        }
        
        button:active, .btn:active {
            transform: translateY(0);
        }
        
        /* Modern card styles */
        .card {
            transition: all 0.3s ease;
        }
        
        .card:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }
        
        /* Improved focus styles */
        button:focus, a:focus, input:focus, select:focus, textarea:focus {
            outline: 2px solid rgba(59, 130, 246, 0.5);
            outline-offset: 2px;
        }
        
        /* Smooth transitions for all interactive elements */
        a, button, input, select, textarea {
            transition: all 0.2s ease;
        }
        
        /* Prevent text size adjustment on iOS */
        @media screen and (max-width: 768px) {
            input, select, textarea {
                font-size: 16px !important;
            }
        }
        
        /* Smooth scrolling */
        html {
            scroll-behavior: smooth;
        }
        
        /* Sidebar item styles */
        .sidebar-item {
            transition: all 0.2s ease;
            min-height: 44px;
            font-weight: 500;
        }
        
        .sidebar-item:hover {
            transform: translateX(2px);
        }
        
        .sidebar-item.active {
            font-weight: 600;
            color: var(--role-primary, #1D3557) !important;
        }
        
        .dark .sidebar-item.active {
            color: var(--role-secondary, #E63946) !important;
        }
        
        .sidebar-item i {
            transition: color 0.2s ease;
            width: 1.25rem;
            text-align: center;
        }
        
        .sidebar-item:hover i {
            color: inherit;
        }
        
        /* Sidebar improvements */
        .sidebar-container {
            display: flex;
            flex-direction: column;
            height: 100%;
        }
        
        .sidebar-nav {
            flex: 1;
            overflow-y: auto;
            overflow-x: hidden;
            padding-bottom: 1rem;
        }
        
        /* Sidebar header section */
        .sidebar-header {
            padding: 1rem;
            border-bottom: 1px solid rgba(0, 0, 0, 0.1);
        }
        
        .dark .sidebar-header {
            border-bottom-color: rgba(255, 255, 255, 0.1);
        }
        
        /* Sidebar footer section */
        .sidebar-footer {
            padding: 1rem;
            border-top: 1px solid rgba(0, 0, 0, 0.1);
            background: rgba(0, 0, 0, 0.02);
            flex-shrink: 0;
        }
        
        .dark .sidebar-footer {
            border-top-color: rgba(255, 255, 255, 0.1);
            background: rgba(255, 255, 255, 0.02);
        }
        
        /* Better spacing for sidebar items */
        .sidebar-nav .sidebar-item {
            margin-bottom: 0.25rem;
        }
        
        /* Active link indicator */
        .sidebar-item.active::before {
            content: '';
            position: absolute;
            left: 0;
            top: 50%;
            transform: translateY(-50%);
            width: 3px;
            height: 60%;
            background: var(--role-primary, #1D3557);
            border-radius: 0 2px 2px 0;
        }
        
        .dark .sidebar-item.active::before {
            background: var(--role-secondary, #E63946);
        }
        
        .sidebar-item {
            position: relative;
        }
        
        /* Footer improvements */
        footer {
            flex-shrink: 0;
        }
        
        /* Responsive footer */
        @media (max-width: 640px) {
            footer {
                padding-top: 0.75rem;
                padding-bottom: 0.75rem;
            }
            
            footer span {
                font-size: 0.7rem;
                line-height: 1.4;
            }
            
            footer i {
                font-size: 0.7rem;
            }
        }
        
        @media (min-width: 641px) and (max-width: 1023px) {
            footer {
                padding-top: 1rem;
                padding-bottom: 1rem;
            }
        }
        
        @media (min-width: 1024px) {
            footer {
                padding-top: 1.25rem;
                padding-bottom: 1.25rem;
            }
        }
    </style>
    
    {% block extra_head %}{% endblock %}
</head>
<body class="text-gray-900 dark:text-gray-100 min-h-screen font-sans transition-colors duration-300">
    
    <!-- Header -->
    <header class="fixed top-0 left-0 right-0 z-50 bg-white dark:bg-gray-800 shadow-md border-b border-gray-200 dark:border-gray-700">
        <div class="container mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between h-16">
                <!-- Left: Logo and Sidebar Toggle -->
                <div class="flex items-center space-x-3 flex-1 min-w-0">
                    <button @click="sidebarOpen = !sidebarOpen; if (isDesktop) userClosedSidebar = !sidebarOpen" 
                            class="p-2 text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors touch-manipulation">
                        <i class="fas fa-bars text-xl" x-show="!sidebarOpen"></i>
                        <i class="fas fa-times text-xl" x-show="sidebarOpen" x-cloak></i>
                    </button>
                    
                    <a href="/" class="flex items-center space-x-2 sm:space-x-3 min-w-0 flex-1 sm:flex-none group">
                        <div class="w-10 h-10 sm:w-12 sm:h-12 bg-gradient-to-br from-brand-primary to-brand-secondary rounded-lg flex items-center justify-center shadow-md overflow-hidden flex-shrink-0">
                                {% if school_settings.school_logo %}
                                <img src="{{ url_for('static', filename=school_settings.school_logo) }}" 
                                     alt="{{ school_settings.school_name or 'School Logo' }}" 
                                     class="w-full h-full object-cover">
                                {% else %}
                            <i class="fas fa-graduation-cap text-white text-lg sm:text-xl"></i>
                                {% endif %}
                            </div>
                        <div class="hidden sm:block min-w-0">
                            <div class="font-heading font-bold text-base sm:text-lg text-gray-900 dark:text-white truncate">
                                {{ school_settings.school_name or 'Modern School' }}
                            </div>
                            <div class="text-xs text-gray-500 dark:text-gray-400 hidden md:block">
                                {% block header_subtitle %}NGO Sponsored Education{% endblock %}
                        </div>
                    </div>
                    </a>
                </div>

                <!-- Right: User Menu / Login -->
                <div class="flex items-center space-x-2 sm:space-x-4 flex-shrink-0">
                    <!-- Dark Mode Toggle -->
                    <button @click="darkMode = !darkMode" 
                            class="p-2 text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors touch-manipulation">
                        <i class="fas fa-moon text-lg" x-show="!darkMode"></i>
                        <i class="fas fa-sun text-lg" x-show="darkMode" x-cloak></i>
                    </button>
                    
                    <!-- User Menu / Login -->
                        {% if session.get('user_id') %}
                    <div class="relative" x-data="{ open: false }">
                        <button @click.stop="open = !open" 
                                class="flex items-center space-x-2 px-3 py-2 bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 rounded-lg transition-colors touch-manipulation">
                            {% if session.get('profile_picture') %}
                            <img src="{{ url_for('static', filename=session.profile_picture) }}" 
                                 alt="Profile" 
                                 class="w-8 h-8 rounded-full object-cover border-2 border-gray-300 dark:border-gray-600">
                            {% else %}
                            <div class="w-8 h-8 bg-brand-primary rounded-full flex items-center justify-center border-2 border-gray-300 dark:border-gray-600">
                                <i class="fas fa-user text-white text-sm"></i>
                                    </div>
                            {% endif %}
                            <span class="hidden sm:inline text-sm font-medium text-gray-700 dark:text-gray-200">
                                {{ session.get('full_name', 'User') }}
                                </span>
                            <i class="fas fa-chevron-down text-xs text-gray-500"></i>
                            </button>
                        
                            <div x-show="open" 
                                 @click.away="open = false" 
                                 x-transition:enter="transition ease-out duration-200"
                                 x-transition:enter-start="opacity-0 scale-95"
                                 x-transition:enter-end="opacity-100 scale-100"
                                 x-transition:leave="transition ease-in duration-150"
                                 x-transition:leave-start="opacity-100 scale-100"
                                 x-transition:leave-end="opacity-0 scale-95"
                             x-cloak
                             class="absolute right-0 mt-2 w-48 bg-white dark:bg-gray-800 rounded-lg shadow-lg border border-gray-200 dark:border-gray-700 py-2 z-50">
                            {% set user_role = session.get('role', 'employee')|lower %}
                            {% set profile_role = 'employee' if user_role in ['employee', 'super admin', 'principal', 'deputy principal', 'academic coordinator', 'teachers', 'accountant', 'librarian', 'warden', 'transport manager', 'technician'] else user_role %}
                            {% if user_role in ['employee', 'super admin', 'principal', 'deputy principal', 'academic coordinator', 'teachers', 'accountant', 'librarian', 'warden', 'transport manager', 'technician'] %}
                            <a href="/dashboard/employee" class="block px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700">
                                <i class="fas fa-tachometer-alt mr-2"></i>Dashboard
                            </a>
                            {% else %}
                            <a href="/dashboard/{{ user_role }}" class="block px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700">
                                <i class="fas fa-tachometer-alt mr-2"></i>Dashboard
                            </a>
                            {% endif %}
                            <a href="/profile/{{ profile_role }}" class="block px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700">
                                <i class="fas fa-user mr-2"></i>Profile
                            </a>
                            <a href="/settings/{{ profile_role }}" class="block px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700">
                                <i class="fas fa-cog mr-2"></i>Settings
                            </a>
                            <hr class="my-1 border-gray-200 dark:border-gray-700">
                            <a href="/logout" class="block px-4 py-2 text-sm text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20">
                                <i class="fas fa-sign-out-alt mr-2"></i>Logout
                                </a>
                            </div>
                        </div>
                        {% else %}
                    <a href="/login" class="px-4 py-2 bg-brand-primary hover:bg-brand-maroon-dark text-white rounded-lg transition-all text-sm font-medium touch-manipulation shadow-sm hover:shadow-md">
                        <i class="fas fa-sign-in-alt mr-2"></i><span class="hidden sm:inline">Login</span>
                    </a>
                        {% endif %}
                </div>
            </div>
        </div>
    </header>

    <!-- Sidebar Overlay (Mobile) -->
    <div x-show="sidebarOpen && !isDesktop"
         @click="sidebarOpen = false"
         @touchmove.prevent
         @wheel.prevent
         x-transition:enter="transition-opacity ease-linear duration-300"
         x-transition:enter-start="opacity-0"
         x-transition:enter-end="opacity-100"
         x-transition:leave="transition-opacity ease-linear duration-300"
         x-transition:leave-start="opacity-100"
         x-transition:leave-end="opacity-0"
         class="fixed inset-0 bg-black bg-opacity-50 z-40 lg:hidden backdrop-blur-sm"
         x-cloak
         style="display: none;"></div>
    
        <!-- Sidebar -->
    <aside class="fixed top-16 left-0 bottom-0 z-40 w-64 bg-white dark:bg-gray-800 border-r border-gray-200 dark:border-gray-700 shadow-xl sidebar-transition sidebar-container"
               :class="sidebarOpen ? 'translate-x-0' : '-translate-x-full'"
               x-transition:enter="transition-transform duration-300 ease-out"
               x-transition:enter-start="-translate-x-full"
               x-transition:enter-end="translate-x-0"
               x-transition:leave="transition-transform duration-300 ease-in"
               x-transition:leave-start="translate-x-0"
           x-transition:leave-end="-translate-x-full"
           @touchmove.stop.prevent
           @wheel.stop.prevent>
        
        <!-- Sidebar Header (Mobile only) -->
        <div class="sidebar-header lg:hidden flex items-center justify-between">
            <span class="font-heading font-bold text-gray-900 dark:text-white text-lg">Menu</span>
            <button @click="sidebarOpen = false" 
                    class="p-2 text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors">
                        <i class="fas fa-times text-xl"></i>
                    </button>
                </div>
                
        <!-- Scrollable Navigation -->
        <nav class="sidebar-nav custom-scrollbar px-4 py-4 space-y-1"
             @touchmove.stop
             @wheel.stop
             style="overscroll-behavior: contain; -webkit-overflow-scrolling: touch;">
            {% block sidebar_content %}
            <!-- Default sidebar links for public pages -->
            <a href="/" class="sidebar-item flex items-center space-x-3 px-4 py-3 rounded-lg text-gray-900 dark:text-gray-100 hover:text-brand-primary dark:hover:text-brand-secondary transition-all {% if request.endpoint == 'home' %}active text-brand-primary dark:text-brand-secondary{% endif %}">
                <i class="fas fa-home"></i>
                <span class="font-medium">Home</span>
            </a>
            <a href="/about" class="sidebar-item flex items-center space-x-3 px-4 py-3 rounded-lg text-gray-900 dark:text-gray-100 hover:text-brand-primary dark:hover:text-brand-secondary transition-all {% if request.endpoint == 'about' %}active text-brand-primary dark:text-brand-secondary{% endif %}">
                <i class="fas fa-info-circle"></i>
                <span class="font-medium">About</span>
            </a>
            <a href="/programs" class="sidebar-item flex items-center space-x-3 px-4 py-3 rounded-lg text-gray-900 dark:text-gray-100 hover:text-brand-primary dark:hover:text-brand-secondary transition-all {% if request.endpoint == 'programs' %}active text-brand-primary dark:text-brand-secondary{% endif %}">
                <i class="fas fa-book"></i>
                <span class="font-medium">Programs</span>
            </a>
            <a href="/gallery" class="sidebar-item flex items-center space-x-3 px-4 py-3 rounded-lg text-gray-900 dark:text-gray-100 hover:text-brand-primary dark:hover:text-brand-secondary transition-all {% if request.endpoint == 'gallery' %}active text-brand-primary dark:text-brand-secondary{% endif %}">
                <i class="fas fa-images"></i>
                <span class="font-medium">Gallery</span>
            </a>
            <a href="/news" class="sidebar-item flex items-center space-x-3 px-4 py-3 rounded-lg text-gray-900 dark:text-gray-100 hover:text-brand-primary dark:hover:text-brand-secondary transition-all {% if request.endpoint == 'news' %}active text-brand-primary dark:text-brand-secondary{% endif %}">
                <i class="fas fa-newspaper"></i>
                <span class="font-medium">News</span>
            </a>
            <a href="/team" class="sidebar-item flex items-center space-x-3 px-4 py-3 rounded-lg text-gray-900 dark:text-gray-100 hover:text-brand-primary dark:hover:text-brand-secondary transition-all {% if request.endpoint == 'team' %}active text-brand-primary dark:text-brand-secondary{% endif %}">
                <i class="fas fa-users"></i>
                <span class="font-medium">Team</span>
            </a>
            <a href="/contact" class="sidebar-item flex items-center space-x-3 px-4 py-3 rounded-lg text-gray-900 dark:text-gray-100 hover:text-brand-primary dark:hover:text-brand-secondary transition-all {% if request.endpoint == 'contact' %}active text-brand-primary dark:text-brand-secondary{% endif %}">
                <i class="fas fa-envelope"></i>
                <span class="font-medium">Contact</span>
            </a>
            {% endblock %}
                </nav>
                
                <!-- Sidebar Footer -->
        <div class="sidebar-footer">
            <div class="text-center">
                <div class="flex items-center justify-center space-x-2 text-sm text-gray-600 dark:text-gray-400">
                    <i class="fas fa-heart text-brand-secondary"></i>
                    <span class="font-medium">NGO Sponsored</span>
                    </div>
                </div>
            </div>
        </aside>

        <!-- Main Content -->
    <main class="pt-16 pb-20 transition-all duration-300 flex flex-col overflow-hidden relative z-10"
          :style="isDesktop && sidebarOpen ? 'margin-left: 16rem;' : 'margin-left: 0;'"
          style="height: calc(100vh - 4rem);">
        <div class="flex-1 overflow-y-auto overflow-x-hidden custom-scrollbar">
            <div class="container mx-auto px-4 sm:px-6 lg:px-8 py-6 sm:py-8 relative z-10">
                {% block content %}{% endblock %}
                                    </div>
                                </div>
        </main>

    <!-- Footer -->
    <footer class="bg-white dark:bg-gray-800 border-t border-gray-200 dark:border-gray-700 mt-auto">
        <div class="container mx-auto px-4 sm:px-6 lg:px-8 py-4 sm:py-5">
            <div class="flex items-center justify-center">
                <div class="flex items-center space-x-2 text-xs sm:text-sm text-gray-600 dark:text-gray-400 text-center">
                    <i class="fas fa-heart text-brand-secondary text-xs sm:text-sm"></i>
                    <span class="font-medium">NGO Sponsored Education Initiative</span>
                </div>
            </div>
        </div>
    </footer>

    <!-- Coming Soon Modal -->
    <div x-show="comingSoonModalOpen" 
         @click.away="comingSoonModalOpen = false"
         @keydown.escape.window="comingSoonModalOpen = false"
         x-transition:enter="transition-opacity ease-out duration-200"
         x-transition:enter-start="opacity-0"
         x-transition:enter-end="opacity-100"
         x-transition:leave="transition-opacity ease-in duration-150"
         x-transition:leave-start="opacity-100"
         x-transition:leave-end="opacity-0"
         class="fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-center justify-center p-4"
         x-cloak
         style="display: none;">
        <div @click.stop
             x-transition:enter="transition-all ease-out duration-200"
             x-transition:enter-start="opacity-0 scale-95"
             x-transition:enter-end="opacity-100 scale-100"
             x-transition:leave="transition-all ease-in duration-150"
             x-transition:leave-start="opacity-100 scale-100"
             x-transition:leave-end="opacity-0 scale-95"
             class="bg-white dark:bg-gray-800 rounded-xl shadow-2xl w-full max-w-md overflow-hidden">
            <!-- Modal Header -->
            <div class="bg-gray-900 px-6 py-4">
                <div class="flex items-center justify-between">
                    <div class="flex items-center space-x-3">
                        <div class="w-10 h-10 bg-white/20 rounded-lg flex items-center justify-center">
                            <i class="fas fa-hourglass-half text-white text-lg"></i>
                        </div>
                        <h3 class="text-xl font-bold text-white" x-text="comingSoonTitle || 'Coming Soon'"></h3>
                        </div>
            <button @click="comingSoonModalOpen = false" 
                            class="text-white/80 hover:text-white hover:bg-white/10 rounded-lg p-2 transition-colors">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
            </div>
            
            <!-- Modal Body -->
            <div class="p-6">
                <p class="text-gray-600 dark:text-gray-400 mb-6 leading-relaxed">
                    This feature is currently under development and will be available soon. We're working hard to bring you the best experience.
                </p>
                <button @click="comingSoonModalOpen = false" 
                        class="w-full px-6 py-3 bg-gray-900 hover:bg-gray-800 text-white rounded-lg font-semibold transition-colors shadow-sm">
                    <i class="fas fa-check mr-2"></i>Got it
                </button>
            </div>
                </div>
            </div>

    <!-- Extra Scripts Block -->
    {% block extra_scripts %}{% endblock %}
    
    <!-- Calendar Script (if needed) -->
    <script>
        // Update calendar if elements exist
        function updateCalendar() {
            const now = new Date();
            const monthNames = ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'];
            const dayNames = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];
            
            const monthHeader = document.getElementById('calendar-month-header');
            const calendarDay = document.getElementById('calendar-day');
            const calendarWeekday = document.getElementById('calendar-weekday');
            const calendarYear = document.getElementById('calendar-year');
            const mobileDate = document.getElementById('mobile-date');
            
            if (monthHeader) monthHeader.textContent = monthNames[now.getMonth()];
            if (calendarDay) calendarDay.textContent = String(now.getDate()).padStart(2, '0');
            if (calendarWeekday) calendarWeekday.textContent = dayNames[now.getDay()];
            if (calendarYear) calendarYear.textContent = now.getFullYear();
            if (mobileDate) mobileDate.textContent = monthNames[now.getMonth()].substring(0, 3) + ' ' + String(now.getDate()).padStart(2, '0');
        }
        
        updateCalendar();
        setInterval(updateCalendar, 60000); // Update every minute
    </script>
</body>
</html>
